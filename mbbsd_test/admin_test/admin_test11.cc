#include "admin_test.h"

TEST_F(AdminTest, MBoard) {
  char buf[TEST_BUFFER_SIZE] = {};

  bzero(buf, TEST_BUFFER_SIZE);
  sprintf(buf, "WhoAmI\r\nq\r\n");
  put_vin((unsigned char *)buf, strlen(buf));

  int ret = m_board();
  EXPECT_EQ(ret, 0);

  refresh();
  log_oflush_buf();

  unsigned char expected[] = "\x1B\x5B\x48\x1B\x5B\x4A\x1B\x5B\x31\x3B\x33\x37\x3B\x34\x36\x6D" //\x1b[H\x1b[J\x1b[1;37;46m
      "\xA1\x69\x20\xAC\xDD\xAA\x4F\xB3\x5D\xA9\x77\x20\xA1\x6A" //【 看板設定 】
      "\x1B\x5B\x6D\x0A\x0D"
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D" //\x1b[0;7m
      "\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x31\x37\x48\x0D" //\x1b[m\x1b[2;17H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x20\x20\x20\x20\x20\x20\x20" //W
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x31\x38\x48\x0D" //\x1b[m\x1b[2;18H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x68\x20" //Wh
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x31\x39\x48\x0D" //\x1b[m\x1b[2;19H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x68\x6F\x20\x20\x20\x20\x20" //Who
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x32\x30\x48\x0D" //\x1b[m\x1b[2;20H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x68\x6F\x41\x20\x20\x20\x20\x20\x20\x20\x20\x20" //WhoA
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x32\x31\x48\x0D" //\x1b[m\x1b[2;21H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20" //請輸入看板名稱:
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x68\x6F\x41\x6D\x20\x20\x20" //WhoAm
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x32\x32\x48\x0D" //\x1b[m\x1b[2;22H
      "\xBD\xD0\xBF\xE9\xA4\x4A\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\x3A\x20"
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x57\x68\x6F\x41\x6D\x49\x20\x20\x20\x20\x20\x20\x20" //WhoAmI
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x20\x20\x20\x20\x20\x20\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x32\x3B\x32\x33\x48" //\x1b[m\x1b[2;23H
      "\x1B\x5B\x34\x3B\x31\x48" //\x1b[4;1H
      "\xAC\xDD\xAA\x4F\xA6\x57\xBA\xD9\xA1\x47\x57\x68\x6F\x41\x6D\x49\x20\x0A\x0D" //看板名稱：WhoAmI
      "\xAC\xDD\xAA\x4F\xBB\xA1\xA9\xFA\xA1\x47\xBC\x54\xAD\xF9\x20" //看板說明：嘰哩
      "\xA1\xB7\xA8\xFE\xA8\xFE\xA1\x41\xB2\x71" //◎呵呵，猜
      "\xB2\x71\xA7\xDA\xAC\x4F\xBD\xD6\xA1\x49\x0A\x0D" //猜我是誰！
      "\xAC\xDD\xAA\x4F\x62\x69\x64\xA1\x47\x31\x30\x0A\x0D" //看板bid：10
      "\xAC\xDD\xAA\x4F\x47\x49\x44\xA1\x47\x35\x0A\x0D" //看板GID：5
      "\xAA\x4F\xA5\x44\xA6\x57\xB3\xE6\xA1\x47\x0A\x0D" //板主名單：
      "\xB3\x5D\xA9\x77\x20\x5B\x57\x68\x6F\x41\x6D\x49" //設定 [WhoAmI
      "\x5D\x20\xAC\xDD\xAA\x4F\xA4\xA7\x28" //] 看板之(
      "\xBE\x5C\xC5\xAA\x29\xC5\x76\xAD\xAD\xA1\x47" //閱讀)權限：
      "\x1B\x5B\x31\x31\x3B\x31\x48" //\x1b[11;1H
      "\x28\x45\x29\xB3\x5D\xA9\x77\x20\x28\x56\x29\xB5\x6F" //(E)設定 (V)發
      "\xA4\xE5\xBC\xFA\xC0\x79\x20\x5B\x51\x5D" //文獎勵 [Q]
      "\xA8\xFA\xAE\xF8\x3F\x20" //取消?
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x20\x20\x20"
      "\x1B\x5B\x6D\x1B\x5B\x31\x31\x3B\x33\x30\x48\x0D"
      "\x28\x45\x29\xB3\x5D\xA9\x77\x20\x28\x56\x29\xB5\x6F" //(E)設定 (V)發
      "\xA4\xE5\xBC\xFA\xC0\x79\x20\x5B\x51\x5D" //文獎勵 [Q]
      "\xA8\xFA\xAE\xF8\x3F\x20" //取消?
      "\x1B\x5B\x30\x3B\x37\x6D"
      "\x71\x20\x20" //q
      "\x1B\x5B\x6D\x1B\x5B\x31\x31\x3B\x33\x31\x48\x0A\x0D" //\x1b[m\x1b[11;31H
      "\0";

  EXPECT_STREQ((char *)OFLUSH_BUF, (char *)expected);
}
