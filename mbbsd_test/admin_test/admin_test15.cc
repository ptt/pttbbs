#include "admin_test.h"

TEST_F(AdminTest, MakeBoardLinkInteractively) {
  char buf[TEST_BUFFER_SIZE] = {};

  bzero(buf, TEST_BUFFER_SIZE);
  sprintf(buf, "yNote\r\n");
  put_vin((unsigned char *)buf, strlen(buf));

  int the_class = 2;
  int ret = make_board_link_interactively(the_class);
  EXPECT_EQ(ret, 0);

  refresh();

  unsigned char expected[] = "\x1B[H\x1B[J\x1B[1;37;46m"
      "\xA1i \xAB\xD8\xA5\xDF\xAC\xDD\xAAO\xB3s\xB5\xB2 \xA1j" //【 建立看板連結 】
      "\x1B[m\x1B[4;1H"
      "\xBD\xD0\xAA`\xB7N: \xAC\xDD\xAAO\xB3s\xB5\xB2\xB7|\xBE\xC9\xADP\xB3s\xB5\xB2\xA9\xD2" //請注意: 看板連結會導致連結所
      "\xA6""b\xAA\xBA\xB8s\xB2\xD5\xA4\xA7\xA4p\xB2\xD5\xAA\xF8\xA4@\xBC\xCB\xA6\xB3\xB8s\xB2\xD5\xBA\xDE\xB2z" //在的群組之小組長一樣有群組管理
      "\xC5""v\xAD\xAD\xA1" "C\n\r" //權限。
      "(\xA8\xD2\xA1" "A\xA6" "b\xB8s\xB2\xD5 A [\xA4p\xB2\xD5\xAA\xF8: abc]\xA4U\xAB\xD8\xA5\xDF" //(例，在群組 A [小組長: abc]下建立
      "\xA4" "F\xB3q\xA9\xB9\xB8s\xB2\xD5 B \xAA\xBA\xAC\xDD\xAAO C \xAA\xBA\xB3s\xB5\xB2\xA1" "A\n\r" //了通往群組 B 的看板 C 的連結，
      " \xB5\xB2\xAAG\xB7|\xBE\xC9\xADP abc \xA6" "b\xB6i\xA4J\xAC\xDD\xAAO C" // 結果會導致 abc 在進入看板 C
      " \xAE\xC9\xA4]\xA6\xB3\xB8s\xB2\xD5\xBA\xDE\xB2z\xC5v\xAD\xAD" "\xA1" "C)" // 時也有群組管理權限。)
      "\x1B[8;1H"
      "\xB3o\xACO\xA4w\xAA\xBE\xB2{\xB6H\xA6\xD3\xA5" "B\xB5L\xB8\xD1\xA1" "C\xA6" "b" //這是已知現象而且無解。在
      "\xAB\xD8\xA5\xDF\xAC\xDD\xAAO\xAE\xC9\xBD\xD0\xBDT\xA9w\xB1z\xA4w" //建立看板時請確定您已
      "\xA4" "F\xB8\xD1\xA5i\xAF\xE0\xB7|\xB5o\xA5\xCD\xAA\xBA\xB0\xDD\xC3" "D\xA1" "C" //了解可能會發生的問題。
      "\x1B[24;1H\x1B[1;36;44m"
      " \xA1\xBB \xBDT\xA9w\xADn\xAB\xD8\xA5\xDF\xB7s\xAC\xDD\xAAO\xB3s\xB5\xB2\xB6\xDC\xA1H [y/N]:                            " // ◆ 確定要建立新看板連結嗎？ [y/N]:
      "\x1B[1;33;46m"
      " [\xAB\xF6\xA5\xF4\xB7N\xC1\xE4\xC4~\xC4\xF2] " // [按任意鍵繼續]
      "\x1B[m\r"
      "\xBD\xD0\xBF\xE9\xA4J\xAC\xDD\xAAO\xA6W\xBA\xD9: " //請輸入看板名稱:
      "\x1B[0;7m"
      "                                "
      "\x1B[m\x1B[K\x1B[24;17H\r"
      "\xBD\xD0\xBF\xE9\xA4J\xAC\xDD\xAAO\xA6W\xBA\xD9: "
      "\x1B[0;7m"
      "N                               "
      "\x1B[m\x1B[24;18H\r"
      "\xBD\xD0\xBF\xE9\xA4J\xAC\xDD\xAAO\xA6W\xBA\xD9: "
      "\x1B[0;7m"
      "No                              "
      "\x1B[m\x1B[24;19H\r"
      "\xBD\xD0\xBF\xE9\xA4J\xAC\xDD\xAAO\xA6W\xBA\xD9: "
      "\x1B[0;7m"
      "Not                             "
      "\x1B[m\x1B[24;20H\r"
      "\xBD\xD0\xBF\xE9\xA4J\xAC\xDD\xAAO\xA6W\xBA\xD9: "
      "\x1B[0;7m"
      "Note                            "
      "\x1B[m\x1B[24;21H\r\x1B[K"
      "\0";

  EXPECT_STREQ((char *)OFLUSH_BUF, (char *)expected);
}
